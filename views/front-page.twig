{% extends "base.twig" %}

{% block content %}
{# FEATURED POSTS CAROUSEL #}
<div class="featured-posts">
  {% if featured_posts is not empty %}
    <div class="carousel js-flickity" data-flickity-options='{"cellAlign": "center", "contain": true, "wrapAround": true}'>
      {% for post in featured_posts %}
        <a class="carousel-card" href="{{ post.link }}">
          {% set banner_image_wide_src = post.meta('_banner_image_wide') ? Image(post.meta('_banner_image_wide')).src : (post.thumbnail.src ?? placeholder_thumbnail_url) %}
          {% set banner_image_narrow_src = post.meta('_banner_image_narrow') ? Image(post.meta('_banner_image_narrow')).src : (post.thumbnail.src ?? placeholder_thumbnail_url) %}
          <img class="object-cover object-center w-full"
            src="{{ banner_image_wide_src }}"
            alt="Banner Image"
            sizes="(max-width: 640px) 640px,
                   (min-width: 641px) 1920px"
            srcset="{{ banner_image_narrow_src }} 640w,
                    {{ banner_image_wide_src }} 1920w"
          />
          <div class="gradient-cover"></div>
        </a>
      {% endfor %}
    </div>
  {% endif %}
</div>

<main class="mt-5 mb-8">
  <section class="latest-posts p-2">
    <h1 class="section-title">最新动态</h1>
    <div class="post-cards">
      {% for post in latest_posts %}

        {# apply diff card template for diff post categories #}
        {% include ["parts/categories/card-#{post.category.slug}.twig", 'parts/categories/card-standard.twig'] %}

      {% endfor %}
    </div>
    <div class="section-ending-controls">
      <a href="{{ function('get_post_type_archive_link', 'post') }}" class="btn btn-see-all">查看所有更新 <i class="icon icon-arrow-right-thin"></i></a>
    </div>
  </section>


  <section class="most-viewed p-2">
    <h1 class="section-title">人气最高</h1>
    <div class="post-cards">
      {% for post in most_viewed %}

        {# apply diff card template for diff post categories #}
        {% include ["parts/categories/card-#{post.category.slug}.twig", 'parts/categories/card-standard.twig'] %}

      {% endfor %}
    </div>
    <div class="section-ending-controls">
      <a href="{{ function('get_post_type_archive_link', 'post') }}" class="btn btn-see-all">查看所有更新 <i class="icon icon-arrow-right-thin"></i></a>
    </div>
  </section>

</main>
{% endblock %}